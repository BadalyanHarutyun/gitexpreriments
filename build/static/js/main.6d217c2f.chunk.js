(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{52:function(e,t,n){"use strict";n.r(t);var s=n(1),a=n(33),c=n.n(a),i=n(2),r=n(19),o=n(3),l=n(16),d=n(0);var u=function(){var e=Object(s.useState)(""),t=Object(i.a)(e,2),n=t[0],a=t[1],c=Object(s.useState)(""),r=Object(i.a)(c,2),o=r[0],u=r[1],j=Object(s.useState)(""),p=Object(i.a)(j,2),h=p[0],m=p[1],b=Object(s.useState)(""),f=Object(i.a)(b,2),O=f[0],g=f[1],x=Object(s.useState)(""),y=Object(i.a)(x,2),v=y[0],N=y[1],w=Object(s.useState)(!0),_=Object(i.a)(w,2),C=_[0],S=_[1];return Object(s.useEffect)((function(){n.length>0&&o.length>0&&-1!==h.indexOf("@")&&-1!==h.indexOf(".")&&""!==O&&O.length>=8&&O===v?S(!1):S(!0)}),[n,o,O,v,h]),Object(d.jsxs)("div",{className:"main",children:[Object(d.jsx)(l.a,{children:Object(d.jsx)("link",{rel:"stylesheet",href:"/component_css/signup.css"})}),Object(d.jsxs)("div",{className:"register",children:[Object(d.jsx)("div",{className:"register__header",children:Object(d.jsx)("h2",{children:"Register"})}),Object(d.jsxs)("div",{className:"register__form",children:[Object(d.jsx)("input",{type:"text",name:"firstName",maxLength:"256",placeholder:" First Name",onChange:function(e){a(e.target.value)}}),Object(d.jsx)("small",{style:{color:"red",display:!n||"none"},children:"Field required"}),Object(d.jsx)("input",{type:"text",name:"lastName",maxLength:"256",placeholder:" Last Name",onChange:function(e){u(e.target.value)}}),Object(d.jsx)("small",{style:{color:"red",display:!o||"none"},children:"Field required"}),Object(d.jsx)("input",{type:"email",name:"email",maxLength:"256",placeholder:" Email",onChange:function(e){m(e.target.value)}}),Object(d.jsx)("small",{style:{color:"red",display:-1===h.indexOf("@")||-1===h.indexOf(".")||"none"},children:"Invalid Email"}),Object(d.jsx)("input",{type:"password",name:"password",maxLength:"256",placeholder:" Password",onChange:function(e){g(e.target.value)}}),Object(d.jsx)("small",{style:{color:"red",display:O.length<8||"none"},children:"Password must contain 8 minimum character"}),Object(d.jsx)("input",{type:"password",name:"ConfirmPassword",maxLength:"256",placeholder:" Confirm Password",onChange:function(e){N(e.target.value)}}),Object(d.jsx)("small",{style:{color:"red",display:v!==O||"none"},children:"Password doesn't match"}),Object(d.jsx)("button",{id:"signUpButton",disabled:C,style:{backgroundColor:C?"red":null},onClick:function(){console.log(n),fetch("/signup",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({firstName:n,lastName:o,email:h,password:O,confirmPassword:v})}).then((function(e){return e.json()})).then((function(e){document.querySelectorAll("input").forEach((function(e){return e.value=""})),alert(e.msg)}))},children:"Sign Up"}),Object(d.jsx)("a",{href:"/",children:"Sign In"})]})]})]})};var j=function(e){var t=Object(s.useState)(""),n=Object(i.a)(t,2),a=n[0],c=n[1],r=Object(s.useState)(""),u=Object(i.a)(r,2),j=u[0],p=u[1],h=Object(s.useState)(""),m=Object(i.a)(h,2),b=m[0],f=m[1],O=Object(o.f)();return Object(s.useEffect)((function(){fetch("/login",{method:"GET",mode:"cors",headers:{"Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(e){console.log(e),"/profile"===e.msg&&O("/profile")}))}),[]),Object(d.jsxs)("div",{className:"main",children:[Object(d.jsx)(l.a,{children:Object(d.jsx)("link",{rel:"stylesheet",href:"/component_css/login.css"})}),Object(d.jsxs)("div",{className:"login__form",children:[Object(d.jsx)("p",{style:{color:"white"},children:b}),Object(d.jsxs)("div",{className:"email_section",children:[Object(d.jsx)("img",{src:"../useremail.png",alt:"useremail"}),Object(d.jsx)("input",{type:"email",maxLength:"256",name:"email",onChange:function(e){c(e.target.value)}})]}),Object(d.jsxs)("div",{className:"password_section",children:[Object(d.jsx)("img",{src:"../userpassword.png",alt:"useremail"}),Object(d.jsx)("input",{type:"password",maxLength:"256",name:"password",onChange:function(e){p(e.target.value)}})]}),Object(d.jsxs)("div",{className:"login__form__links",children:[Object(d.jsx)("a",{href:"/register",children:"Create New Account"}),Object(d.jsx)("a",{href:"/forgetpassword",children:"Forgot Password?"})]}),Object(d.jsx)("button",{onClick:function(){fetch("/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:a,password:j})}).then((function(e){return e.json()})).then((function(e){console.log(e),"success"!==e.msg?(console.log(e.msg),f(e.msg)):O("/profile")}))},className:"submit__class",children:"Login"})]})]})},p=n(31),h=n(26),m=n.n(h),b=n(30),f=n(29),O=["user","dispatch"];var g=function(e){var t=e.user,n=e.dispatch,a=Object(f.a)(e,O);console.log(a),console.log(t),console.log(window.location.href);var c=Object(o.f)(),r=Object(s.useState)(""),l=Object(i.a)(r,2),u=l[0],j=l[1],p=Object(s.useState)(""),h=Object(i.a)(p,2),m=h[0],b=h[1],g=Object(s.useState)(""),x=Object(i.a)(g,2),y=x[0],v=x[1],N=Object(s.useState)(""),w=Object(i.a)(N,2),_=w[0],C=w[1],S=Object(s.useState)(""),k=Object(i.a)(S,2),T=k[0],E=k[1];return Object(s.useEffect)((function(){document.getElementById("onlineUsers").style.display="none"}),[]),Object(s.useEffect)((function(){j(t.firstName)}),[t]),Object(s.useEffect)((function(){v(t.lastName)}),[t]),Object(s.useEffect)((function(){b(t.email)}),[t]),Object(d.jsxs)("div",{className:"profile__section",children:[Object(d.jsx)("img",{src:_||t.photo||"/avatar.png",className:"profile__picture",alt:"profile"}),Object(d.jsx)("small",{style:{color:"red",display:T.size>2097152||"none"},children:"image max size is 2 megabyte"}),Object(d.jsx)("input",{type:"file",onChange:function(e){return function(e){if(E(e.target.files[0]),console.log(e.target.files[0]),e.target.files&&e.target.files[0]){var t=new FileReader;t.onload=function(e){C(e.target.result)},t.readAsDataURL(e.target.files[0])}}(e)}}),Object(d.jsx)("label",{htmlFor:"firstName",children:"First Name"}),Object(d.jsx)("input",{type:"text",name:"firstName",maxLength:"256",value:u||"",onChange:function(e){return j(e.target.value)}}),Object(d.jsx)("small",{style:{color:"red",display:!u||"none"},children:"Field required"}),Object(d.jsx)("label",{htmlFor:"lastName",children:"Last Name"}),Object(d.jsx)("input",{type:"text",name:"lastName",maxLength:"256",value:y||"",onChange:function(e){return v(e.target.value)}}),Object(d.jsx)("small",{style:{color:"red",display:!y||"none"},children:"Field required"}),Object(d.jsx)("label",{htmlFor:"email",children:"Email"}),Object(d.jsx)("input",{type:"email",name:"email",maxLength:"256",value:m||"",onChange:function(e){return b(e.target.value)}}),Object(d.jsx)("small",{style:{color:"red",display:!m||-1===m.indexOf("@")||-1===m.indexOf(".")||"none"},children:"Invalid Email"}),Object(d.jsx)("button",{className:"logout__button",onClick:function(){n({type:"display"}),c("/profile")},children:"Cancel"}),Object(d.jsx)("button",{className:"edit__button",style:{backgroundColor:!u||T.size>2097152||!y||-1===m.indexOf("@")||-1===m.indexOf(".")?"red":null},disabled:!u||T.size>2097152||!y,onClick:function(){console.log(T),fetch("/api/editprofile",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({firstName:u,lastName:y,email:m})}).then((function(e){return e.json()})).then((function(e){"success"===e.msg||alert(e.msg)})).then((function(){if(""===T)return n({type:"display"}),void c("/profile");var e=new FormData;e.append("picture",T),fetch("/api/editprofileimage",{method:"POST",body:e}).then((function(e){return e.json()})).then((function(e){"success"===e.msg?(E(""),n({type:"display"}),c("/profile")):alert(e.msg)}))}))},children:"Save"})]})},x=n(39),y=["dispatch","profileDisplay"],v=Object(x.a)("harut-app.herokuapp.com");var N=function(e){var t=e.dispatch,n=e.profileDisplay,a=(Object(f.a)(e,y),Object(o.f)()),c=Object(s.useState)(!0),r=Object(i.a)(c,2),u=(r[0],r[1]),j=Object(s.useState)(""),h=Object(i.a)(j,2),O=h[0],x=h[1],N=Object(s.useState)([]),w=Object(i.a)(N,2),_=w[0],C=w[1],S=Object(s.useState)([]),k=Object(i.a)(S,2),T=k[0],E=k[1],I=Object(s.useState)(""),P=Object(i.a)(I,2),L=P[0],F=P[1],U=Object(s.useState)(""),q=Object(i.a)(U,2),J=q[0],B=q[1],A=Object(s.useState)(""),D=Object(i.a)(A,2),z=D[0],H=D[1],R=Object(s.useState)({}),G=Object(i.a)(R,2),Y=G[0],K=G[1];function M(){return(M=Object(b.a)(m.a.mark((function e(){var t,n,s;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t="",console.log(z),""===z){e.next=11;break}return t="image",t=-1!==J.indexOf("video")?"video":"image",(n=new FormData).append("picture",z),n.append("name",Y.firstName),n.append("receiverId",L),n.append("type",t),e.abrupt("return",fetch("/api/sendmessagefile",{method:"POST",headers:{},body:n}).then((function(e){return e.json()})).then((function(e){console.log("mydata",e),console.log("Adsq234cfdsr"),H(""),B(""),v.emit("hello",e.msg,L,Y.firstName,Y.id,t),window.scrollTo(0,document.body.scrollHeight)})).catch((function(e){return console.log("error upload ")})));case 11:return e.next=13,fetch("/api/sendmessage",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:Y.firstName,receiverId:L,data:O})});case 13:s=e.sent,console.log(s),v.emit("hello",O,L,Y.firstName,Y.id,t),window.scrollTo(0,document.body.scrollHeight),document.querySelector("textarea").value="",x("");case 19:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return console.log(_),Object(s.useEffect)((function(){function e(){return(e=Object(b.a)(m.a.mark((function e(){var t,n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/profile",{method:"GET",mode:"cors",headers:{"Content-Type":"application/json"}});case 2:return t=e.sent,e.next=5,t.json();case 5:"/"!==(n=e.sent).msg?K(n):a("/");case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[n]),Object(s.useEffect)((function(){v.emit("addUser",Y.id,Y.firstName,Y.photo)}),[Y.firstName,Y.photo]),Object(s.useEffect)((function(){v.on("hello",(function(e){console.log("asdasd1",e),"connected"!==e&&(window.scrollTo(0,document.body.scrollHeight),C((function(t){return[].concat(Object(p.a)(t),[e])})))}))}),[]),Object(s.useEffect)((function(){v.on("getUsers",(function(e){console.log(e),E(e)}))}),[]),Object(s.useEffect)((function(){v.on("getNotification",(function(e){console.log("notification",e),new Audio("mixkit-software-interface-start-2574.wav").play(),"green"!==document.querySelector('[data-id="'.concat(e.userId,'"]')).style.backgroundColor&&(document.querySelector('[data-id="'.concat(e.userId,'"]')).children[0].children[2].style.display="inline")}))}),[]),Object(d.jsxs)("div",{className:"main",children:[Object(d.jsx)(l.a,{children:Object(d.jsx)("link",{rel:"stylesheet",href:"/component_css/profile.css"})}),Object(d.jsx)(o.c,{children:Object(d.jsx)(o.a,{exact:!0,path:"/edit",element:Object(d.jsx)(g,{dispatch:t,user:Y})})}),Object(d.jsxs)("div",{id:"profile",style:{display:n},className:"profile__section",children:[Object(d.jsx)("i",{id:"onlineUsersicon",onClick:function(){t({type:"none"})},className:"fas fa-arrow-circle-left"}),Object(d.jsx)("img",{src:null===Y.photo?"/avatar.png":Y.photo,className:"profile__picture",alt:"profile"}),Object(d.jsx)("div",{className:"firstname__section",children:Object(d.jsxs)("p",{children:[Y.firstName," ",Y.lastName]})}),Object(d.jsx)("div",{className:"email__section",children:Object(d.jsx)("p",{children:Y.email})}),Object(d.jsx)("button",{className:"logout__button",onClick:function(){v.emit("logout"),fetch("/logout",{method:"POST",headers:{"Content-Type":"application/json"}}).then((function(e){return a("/")}))},children:"Logout"}),Object(d.jsx)("button",{className:"edit__button",onClick:function(){t({type:"none"}),u("none"),a("/profile/edit")},children:"Edit"})]}),Object(d.jsxs)("div",{id:"onlineUsers",style:{display:"none"===n||"none"},className:"profile__section",children:[Object(d.jsx)("div",{onClick:function(){t({type:"display"})},id:"settingsIcon",children:Object(d.jsx)("i",{className:"fas fa-bars"})}),Object(d.jsx)("h2",{children:"Online"}),Object(d.jsx)("ul",{children:T&&T.map((function(e,t){return e.userId!==Y.id?Object(d.jsx)("li",{"data-id":e.userId,onClick:function(e){!function(e){Object(p.a)(document.getElementById("onlineUsers").children[2].children).map((function(e){return e.style.backgroundColor="inherit"})),console.log(e.target,e.currentTarget),e.currentTarget.style.backgroundColor="green",e.currentTarget.children[0].children[2].style.display="none",fetch("/api/getmessage",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({receiverId:Number(e.target.parentNode.getAttribute("data-id"))})}).then((function(e){return e.json()})).then((function(e){return C(e)})).then((function(){return window.scrollTo(0,document.body.scrollHeight)})),F(Number(e.target.parentNode.getAttribute("data-id")))}(e)},children:Object(d.jsxs)("div",{className:"active__user","data-id":e.userId,children:[Object(d.jsx)("img",{width:"50px",src:null===e.photo?"/avatar.png":e.photo,className:"profile__picture",alt:"profile"}),Object(d.jsx)("p",{children:e.name}),Object(d.jsx)("i",{style:{display:"none"},className:"fa fa-comment","aria-hidden":"true"})]})},t):null}))})]}),Object(d.jsx)("div",{className:"posts__section",children:Object(d.jsx)("ul",{className:"message__section",children:_.map((function(e,t){return L===e.receiverId||e.userId===L?"image"===e.type?Object(d.jsx)("li",{style:{left:e.userId===Y.id?"100px":null,background:e.userId===Y.id?"white":"linear-gradient(#9ed387, #77ba5a)"},children:Object(d.jsx)("img",{onError:function(t){return t.target.src=e.data},style:{height:"100px",width:"100px",transform:"translate(16%,3%)"},alt:"somemessage",src:e.data})},t):"video"===e.type?Object(d.jsx)("li",{style:{left:e.userId===Y.id?"100px":null,background:e.userId===Y.id?"white":"linear-gradient(#9ed387, #77ba5a)",height:"300px"},children:Object(d.jsx)("div",{style:{height:"inherit"},children:Object(d.jsxs)("video",{style:{height:"100%",width:"150px"},controls:!0,onClick:function(e){return e.target.play()},children:[Object(d.jsx)("source",{src:e.data,type:"video/mp4"}),"Your browser does not support the video tag. I suggest you upgrade your browser.",Object(d.jsx)("source",{src:e.data,type:"video/ogg"}),"Your browser does not support the video tag. I suggest you upgrade your browser."]})})},t):Object(d.jsx)("li",{style:{left:e.userId===Y.id?"100px":null},children:Object(d.jsx)("p",{style:{background:e.userId===Y.id?"white":"linear-gradient(#9ed387, #77ba5a)"},children:e.data})},t):null}))})}),Object(d.jsxs)("div",{className:"textarea__section",children:[Object(d.jsx)("textarea",{onChange:function(e){return x(e.target.value)}}),Object(d.jsx)("button",{className:"edit__button",onClick:function(){!function(){M.apply(this,arguments)}()},children:Object(d.jsx)("i",{className:"fas fa-paper-plane"})}),Object(d.jsx)("button",{className:"edit__button",onClick:function(){document.getElementById("inpFile").click()},children:Object(d.jsx)("i",{className:"fas fa-paperclip"})}),Object(d.jsx)("input",{id:"inpFile",type:"file",style:{display:"none"},onChange:function(e){return H((t=e).target.files[0]),B(t.target.files[0].type),void console.log(t.target.files[0]);var t}})]})]})};var w=function(){var e=Object(s.useState)(""),t=Object(i.a)(e,2),n=t[0],a=t[1],c=Object(s.useState)(""),r=Object(i.a)(c,2),o=r[0],u=r[1];return Object(d.jsxs)("div",{className:"main",children:[Object(d.jsx)(l.a,{children:Object(d.jsx)("link",{rel:"stylesheet",href:"/component_css/signup.css"})}),Object(d.jsxs)("div",{className:"register",children:[Object(d.jsx)("div",{className:"register__header",children:Object(d.jsx)("h2",{children:"Send Email For New Password"})}),Object(d.jsxs)("div",{className:"register__form",children:[Object(d.jsx)("p",{style:{color:"red",display:!!o||"none"},children:o}),Object(d.jsx)("input",{type:"email",name:"email",maxLength:"256",placeholder:" Email",onChange:function(e){a(e.target.value)}}),Object(d.jsx)("button",{id:"signUpButton",onClick:function(){fetch("/api/forgetpassword/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:n})}).then((function(e){return e.json()})).then((function(e){"success"===e.msg?alert("Please check your email"):u(e.msg)}))},children:"Send"}),Object(d.jsx)("a",{href:"/",children:"Sign In"})]})]})]})};var _=function(){var e=Object(s.useState)(""),t=Object(i.a)(e,2),n=t[0],a=t[1],c=Object(s.useState)(""),r=Object(i.a)(c,2),u=r[0],j=r[1],p=Object(o.f)();return Object(s.useEffect)((function(){fetch("/api".concat(window.location.pathname),{method:"GET",mode:"cors",headers:{"Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(e){"success"!==e.msg&&(document.getElementsByClassName("main")[0].display="none",alert("time expired please try again"),p("/"))}))}),[]),Object(d.jsxs)("div",{className:"main",children:[Object(d.jsx)(l.a,{children:Object(d.jsx)("link",{rel:"stylesheet",href:"/component_css/signup.css"})}),Object(d.jsxs)("div",{className:"register",children:[Object(d.jsx)("div",{className:"register__header",children:Object(d.jsx)("h2",{children:"Confirm password"})}),Object(d.jsxs)("div",{className:"register__form",children:[Object(d.jsx)("input",{type:"password",name:"password",maxLength:"256",placeholder:" New Password",onChange:function(e){a(e.target.value)}}),Object(d.jsx)("small",{style:{color:"red",display:n.length<8||"none"},children:"Password must contain 8 minimum character"}),Object(d.jsx)("input",{type:"password",name:"ConfirmPassword",maxLength:"256",placeholder:" Confirm Password",onChange:function(e){j(e.target.value)}}),Object(d.jsx)("small",{style:{color:"red",display:u!==n||"none"},children:"Password doesn't match"}),Object(d.jsx)("button",{id:"signUpButton",onClick:function(){fetch("/api".concat(window.location.pathname),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({password:n,confirmPassword:u})}).then((function(e){return e.json()})).then((function(e){alert(e.msg),p("/")}))},disabled:""===n||u!==n,children:"Confirm"})]})]})]})},C={count:"none"};function S(e,t){switch(t.type){case"display":return{count:!0};case"none":return{count:"none"};default:throw new Error}}var k=function(){var e=Object(s.useReducer)(S,C),t=Object(i.a)(e,2),n=t[0],a=t[1];return Object(d.jsx)(r.a,{children:Object(d.jsxs)(o.c,{children:[Object(d.jsx)(o.a,{exact:!0,path:"/register",element:Object(d.jsx)(u,{})}),Object(d.jsx)(o.a,{exact:!0,path:"/profile/*",element:Object(d.jsx)(N,{profileDisplay:n.count,dispatch:a})}),Object(d.jsx)(o.a,{exact:!0,path:"/forgetpassword",element:Object(d.jsx)(w,{})}),Object(d.jsx)(o.a,{exact:!0,path:"/confirmpassword/*",element:Object(d.jsx)(_,{})}),Object(d.jsx)(o.a,{exact:!0,path:"/",element:Object(d.jsx)(j,{})})]})})};c.a.render(Object(d.jsx)(k,{}),document.getElementById("root"))}},[[52,1,2]]]);
//# sourceMappingURL=main.6d217c2f.chunk.js.map